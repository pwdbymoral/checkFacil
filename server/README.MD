# ğŸ‰ CheckFacil - Backend API

Sistema de gestÃ£o de festas infantis do **EspaÃ§o Criar**, responsÃ¡vel por:
- LÃ³gica de negÃ³cios
- AutenticaÃ§Ã£o via JWT
- GestÃ£o de festas, clientes e convidados
- IntegraÃ§Ãµes com webhooks (n8n)

---

## ğŸ› ï¸ Tecnologias Utilizadas

- **Node.js** â€“ Ambiente de execuÃ§Ã£o JavaScript
- **Express.js** â€“ Framework para criaÃ§Ã£o de APIs
- **Sequelize** â€“ ORM para MySQL
- **MySQL** â€“ Banco de dados relacional
- **JWT** â€“ AutenticaÃ§Ã£o de rotas
- **Axios** â€“ RequisiÃ§Ãµes HTTP (ex: integraÃ§Ã£o com n8n)
- **CORS** â€“ LiberaÃ§Ã£o de origens para o frontend
- **dotenv** â€“ VariÃ¡veis de ambiente
- **bcryptjs** â€“ Hash seguro de senhas
- **Yarn Workspaces** â€“ Monorepo

---

## âš™ï¸ ConfiguraÃ§Ã£o do Ambiente

### âœ”ï¸ PrÃ©-requisitos

- Node.js `v22.x` ou superior  
- Yarn `v4.x` ou superior  
- Banco de dados MySQL ativo  

### ğŸ“¦ InstalaÃ§Ã£o

```bash
yarn install
```

### ğŸ” VariÃ¡veis de Ambiente

Crie um arquivo `.env` na pasta `/server` com:

```env
# Banco de Dados
DB_HOST=localhost
DB_USER=seu_usuario_mysql
DB_PASSWORD=sua_senha_mysql
DB_NAME=checkfacil_db
DB_PORT=3306

# JWT
JWT_SECRET=gere_um_segredo_forte_e_aleatorio_aqui

# Porta do Servidor
PORT=3001
```

---

## ğŸš€ ExecuÃ§Ã£o do Projeto

Modo desenvolvimento (somente o backend):

```bash
yarn dev:server
```

Frontend + Backend juntos:

```bash
yarn dev
```

A API estarÃ¡ disponÃ­vel em: [http://localhost:3001](http://localhost:3001)

---

## ğŸ”‘ AutenticaÃ§Ã£o

Todas as rotas protegidas exigem o token JWT:

```http
Authorization: Bearer SEU_TOKEN_JWT_AQUI
```

---

## ğŸ“š Endpoints da API

### ğŸ›¡ï¸ Auth (`/auth`)

| MÃ©todo | Rota                          | DescriÃ§Ã£o                                       |
|--------|-------------------------------|-------------------------------------------------|
| POST   | `/auth/register/admEspaco`    | Registra um novo administrador do espaÃ§o        |
| POST   | `/auth/register/admFesta`     | Registra um novo administrador da festa         |
| POST   | `/auth/login`                 | Login e retorno do token JWT                    |
| POST   | `/auth/definir-senha`         | DefiniÃ§Ã£o de senha com token enviado por email  |

#### ğŸ”¸ Exemplo: Login

```json
{
  "email": "admin@exemplo.com",
  "senha": "senha_forte_aqui"
}
```

#### ğŸ”¸ Exemplo: Definir Senha

```json
{
  "token": "token_de_uso_unico_enviado_no_link",
  "novaSenha": "nova_senha_forte"
}
```

---

### ğŸ‰ Festas (`/festa`)

ğŸ” Requer autenticaÃ§Ã£o

| MÃ©todo | Rota               | DescriÃ§Ã£o                                      |
|--------|--------------------|-----------------------------------------------|
| POST   | `/festa/criar`     | Cria uma nova festa associada a um cliente    |
| GET    | `/festa/listar`    | Lista festas (todas ou do prÃ³prio usuÃ¡rio)    |
| PATCH  | `/festa/:idFesta`  | Atualiza dados de uma festa                   |
| DELETE | `/festa/:idFesta`  | Remove uma festa                              |

#### ğŸ”¸ Exemplo: Criar Festa

```json
{
  "dadosFesta": {
    "nome_festa": "Festa IncrÃ­vel",
    "data_festa": "2025-12-25",
    "pacote_escolhido": "SUPER_FESTA_COMPLETA"
  },
  "dadosCliente": {
    "nome": "Cliente Feliz",
    "email": "cliente.feliz@exemplo.com",
    "telefone": "79988887777"
  }
}
```

#### ğŸ” Filtros DisponÃ­veis:

```http
GET /festa/listar
GET /festa/listar?data=2025-12-25
GET /festa/listar?data_inicio=2025-12-01&data_fim=2025-12-31
```

---

### ğŸ§‘â€ğŸ¤â€ğŸ§‘ Convidados (`/festa/:idFesta/convidados`)

ğŸ” Requer autenticaÃ§Ã£o

| MÃ©todo | Rota                                                          | DescriÃ§Ã£o                          |
|--------|---------------------------------------------------------------|------------------------------------|
| POST   | `/festa/:idFesta/convidados`                                  | Adiciona novo convidado            |
| GET    | `/festa/:idFesta/convidados`                                  | Lista todos os convidados          |
| GET    | `/festa/:idFesta/convidados/buscar?nome=Silva`                | Busca convidados por nome          |
| PATCH  | `/festa/:idFesta/convidados/:idConvidado`                     | Atualiza dados de um convidado     |
| DELETE | `/festa/:idFesta/convidados/:idConvidado`                     | Remove um convidado                |

#### ğŸ”¸ Exemplo: Adicionar Convidado

```json
{
  "nome_convidado": "JoÃ£o da Silva",
  "tipo_convidado": "ADULTO_PAGANTE",
  "idade_convidado": 30,
  "nome_responsavel": null,
  "telefone_responsavel": null
}
```

---

## ğŸ“Œ ObservaÃ§Ãµes Finais

- Em produÃ§Ã£o, proteja os endpoints `/auth/register/*`
- Integre com **n8n**, WhatsApp ou CRM conforme necessÃ¡rio
